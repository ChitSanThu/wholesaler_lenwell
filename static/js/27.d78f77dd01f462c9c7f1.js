webpackJsonp([27],{W47L:function(t,e){},dsWl:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),l=s("z2X1"),c=s.n(l),n={data:function(){return{lang:this.$i18n.locale,checkedAll:!1,selectTotal:0,selectTotalPrice:"0.00",payPrice:0,list:[],userinfo:[],discountList:[],discountNum:0}},created:function(){this.userinfo=c.a.getItem("userinfo"),""==this.userinfo&&this.$message.error("Login has expired, please login again"),this.getUserDiscount(),this.getCartList()},methods:{goHome:function(){this.$router.push("/")},goRepairCart:function(){this.$router.push("/repaircart")},getUserDiscount:function(){var t=this;t.$request.getUserdiscount().then(function(e){1==e.code&&(t.discountList=e.data,console.log(t.discountList))})},getCartList:function(){var t=this;t.$request.GoodsCartGetList({}).then(function(e){if(1==e.code){for(var s in e.data.list){var i=e.data.list[s].price*e.data.list[s].nums;e.data.list[s].totalPrice=t.returnFloat(i),e.data.list[s].checked=!1}t.list=e.data.list}})},setCatItemNums:function(t,e,s){var i=0,a=0,l=this.selectTotalPrice;if(1==this.list[e].nums&&"jian"==s)return!1;"jia"==s?(i=this.list[e].nums+1,a=Number(this.list[e].totalPrice,2)+Number(this.list[e].price,2),l=Number(l,2)+Number(this.list[e].price,2)):"jian"==s&&(i=this.list[e].nums-1,a=Number(this.list[e].totalPrice,2)-Number(this.list[e].price,2),l=Number(l,2)-Number(this.list[e].price,2)),i<=1&&(i=1),this.$request.GoodsCartSetNums({id:t.id,nums:i}).then(),this.list[e].nums=i,this.list[e].totalPrice=this.returnFloat(a),!0===t.checked&&(this.selectTotalPrice=this.returnFloat(l),this.handleDiscount())},returnFloat:function(t){var e=(t=Math.round(100*parseFloat(t))/100).toString().split(".");return 1==e.length?t=t.toString()+".00":e.length>1?(e[1].length<2&&(t=t.toString()+"0"),t):void 0},selectCartAll:function(t){var e=0;for(var s in this.list)this.list[s].checked=t,!0===t&&(e+=Number(this.list[s].totalPrice));!0===t?this.selectTotal=this.list.length:(this.selectTotal=0,e=0,this.discountNum=0),this.selectTotalPrice=this.returnFloat(e),this.handleDiscount()},selectCartItem:function(t,e){var s=this.selectTotalPrice;!0===t.checked?(this.selectTotal++,s=Number(s)+Number(t.totalPrice)):(this.selectTotal--,s=Number(s)-Number(t.totalPrice)),this.selectTotal==this.list.length?this.checkedAll=!0:this.checkedAll=!1,this.selectTotalPrice=this.returnFloat(s),this.handleDiscount()},deleteCar:function(t,e){var s=[],i=this,a=[];if(void 0==t||null==t||""==t){for(var l in i.list)!0===i.list[l].checked&&(s.push(i.list[l].id),i.list[l].indexkey=l,a.push(i.list[l]));if(s.length<=0)return i.$message.error("Please select an goods"),!1;s=s.join(",")}else s=t.id,t.indexkey=e,a.push(t);i.$request.GoodsCartDel({id:s}).then(function(t){if(1==t.code){for(var e in i.$message.success("Deleted successfully"),a){var s=Number(a[e].indexkey);i.list.splice(s,1)}var l=0,c=0;for(var n in i.list)!0===i.list[n].checked&&(l+=Number(i.list[n].totalPrice),c++);i.selectTotalPrice=i.returnFloat(l),i.selectTotal=c,i.handleDiscount()}})},createOrder:function(){if(void 0==this.userinfo||null==this.userinfo||""==this.userinfo)return this.$message.error("Please login first"),!1;if(this.selectTotal<=0)return this.$message.error("Please select an goods"),!1;var t=[];for(var e in this.list)if(!0===this.list[e].checked){var s={goods_id:this.list[e].goods.id,sku_id:"",nums:this.list[e].nums,cart_id:this.list[e].id};void 0!=this.list[e].sku&&null!=this.list[e].sku&&""!=this.list[e].sku&&(s.sku_id=this.list[e].sku.id),t.push(s)}if(t.length<=0)return this.$message.error("Please select an goods"),!1;var i=encodeURI(a()(t));this.$router.push("/goods/trueorder?id="+i)},handleDiscount:function(){if(this.discountList&&this.discountList.length>0)for(var t in this.discountList){var e=this.discountList[t];e.price_start<=this.selectTotalPrice&&this.selectTotalPrice<=e.price_end&&(this.discountNum=e.preferential_quota,this.payPrice=100*Number(this.selectTotalPrice)*Number(this.discountNum)/1e4,this.payPrice=this.returnFloat(this.payPrice))}0==this.selectTotal&&(this.discountNum=0)}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"web_cart_container"},[i("div",{staticClass:"view_nav"},[i("div",{staticClass:"go_nav",on:{click:function(e){return t.goHome()}}},[t._v("Home")]),t._v(" "),i("div",[t._v(">")]),t._v(" "),i("div",[t._v("My Cart")])]),t._v(" "),i("div",{staticClass:"order_type_con"},[i("div",{staticClass:"fl order_type_con_active"},[t._v("Goods carts")]),t._v(" "),i("div",{staticClass:"fl",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.goRepairCart()}}},[t._v("My Repair carts")])]),t._v(" "),i("div",{staticClass:"web_infocontainer web_cartinfo_container"},[i("div",{staticClass:"web_cart_thead"},[i("div",{staticClass:"column t-checkbox"},[i("el-checkbox",{on:{change:t.selectCartAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v(t._s("ch"==t.lang?"全选":"Select all"))])],1),t._v(" "),i("div",{staticClass:"column t-goods"},[t._v(t._s("ch"==t.lang?"商品":"Items"))]),t._v(" "),i("div",{staticClass:"column t-price"},[t._v(t._s("ch"==t.lang?"单价":"Unit Price"))]),t._v(" "),i("div",{staticClass:"column t-quantity"},[t._v(t._s("ch"==t.lang?"数量":"Quantity"))]),t._v(" "),i("div",{staticClass:"column t-sum"},[t._v(t._s("ch"==t.lang?"小计":"Subtotal"))]),t._v(" "),i("div",{staticClass:"column t-action"},[t._v(t._s("ch"==t.lang?"操作":""))])]),t._v(" "),i("div",{staticClass:"web_cart_contents"},t._l(t.list,function(e,s){return t.list?i("div",{key:s,staticClass:"web_cart_item"},[i("div",{staticClass:"web_cart_item-item",class:e.checked?"web_cart_item-itemselect":""},[i("div",{staticClass:"item-form"},[i("div",{staticClass:"cell p-checkbox"},[i("el-checkbox",{on:{change:function(i){return t.selectCartItem(e,s)}},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"item.checked"}})],1),t._v(" "),i("div",{staticClass:"cell p-goods"},[i("img",{attrs:{src:e.goods.image_full,alt:""}}),t._v(" "),i("div",{staticClass:"goods_info"},[i("div",{staticClass:"title"},[t._v(t._s(e.goods.title))]),t._v(" "),e.sku?i("div",{staticClass:"sku"},[t._v(t._s(e.sku.title))]):t._e()])]),t._v(" "),i("div",{staticClass:"cell p-price"},[t._v("$"+t._s(e.price))]),t._v(" "),i("div",{staticClass:"cell p-quantity"},[i("div",{staticClass:"jian",on:{click:function(i){return t.setCatItemNums(e,s,"jian")}}},[t._v("-")]),t._v(" "),i("input",{staticClass:"nums",attrs:{type:"text"},domProps:{value:e.nums}}),t._v(" "),i("div",{staticClass:"jia",on:{click:function(i){return t.setCatItemNums(e,s,"jia")}}},[t._v("+")])]),t._v(" "),i("div",{staticClass:"cell p-sum"},[t._v("$"+t._s(e.totalPrice))]),t._v(" "),i("div",{staticClass:"cell p-ops"},[i("el-popconfirm",{attrs:{"confirm-button-text":"True","cancel-button-text":"False",icon:"el-icon-info","icon-color":"red",title:"Are you sure you want to delete？"},on:{confirm:function(i){return t.deleteCar(e,s)}}},[i("el-button",{staticClass:"web_car_delbtn",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v(t._s("ch"==t.lang?"删除":"Delete"))])],1)],1)])])]):t._e()}),0),t._v(" "),t.list&&t.list.length>0?i("div",{staticClass:"web_cart-toolbar"},[i("div",{staticClass:"left fl"},[i("el-checkbox",{on:{change:t.selectCartAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v(t._s("ch"==t.lang?"全选":"Select all"))]),t._v(" "),i("div",{staticClass:"delete_all_btn",on:{click:function(e){return t.deleteCar()}}},[t._v(t._s("ch"==t.lang?"删除选中的商品":"Delete the selected items"))])],1),t._v(" "),i("div",{staticClass:"right fr"},[i("div",[i("div",[i("div",{staticClass:"fl",staticStyle:{"margin-right":"15px"}},[t._v(t._s("ch"==t.lang?"已选择":"Selected")),i("span",{staticStyle:{color:"#e2231a","font-weight":"700","font-family":"verdana",margin:"0 3px"}},[t._v(t._s(t.selectTotal))]),t._v(t._s("ch"==t.lang?"件商品":"items"))]),t._v(" "),i("div",{staticClass:"fl",staticStyle:{"margin-right":"30px"}},[t._v(t._s("ch"==t.lang?"总价":"Total price")+"："),i("span",{staticStyle:{"font-size":"16px",color:"#e2231a","font-family":"verdana","font-weight":"700"}},[t._v("$"+t._s(t.selectTotalPrice))])]),t._v(" "),t.payPrice>0?i("div",{staticClass:"fl",staticStyle:{"margin-right":"30px"}},[t._v(t._s("ch"==t.lang?"支付价":"Payment price")+"："),i("span",{staticStyle:{"font-size":"16px",color:"#e2231a","font-family":"verdana","font-weight":"700"}},[t._v("$"+t._s(t.payPrice))])]):t._e()]),t._v(" "),t.discountNum>0?i("div",{staticClass:"PreferentialTips"},[t._v("\n            优惠 "),i("span",{staticStyle:{color:"#00a0e9"}},[t._v(t._s(t.discountNum)+"%")])]):t._e()]),t._v(" "),i("div",{staticClass:"common-submit-btn",on:{click:function(e){return t.createOrder()}}},[t._v(t._s("ch"==t.lang?"去结算":"Pay"))])])]):i("div",{staticStyle:{width:"max-content",margin:"auto","text-align":"center"}},[i("img",{staticStyle:{width:"150px"},attrs:{src:s("mAJy"),alt:""}}),t._v(" "),i("div",[t._v("You haven't joined the shopping cart yet,\n        "),i("router-link",{staticStyle:{color:"#00a0e9",cursor:"pointer"},attrs:{to:{path:"/shopping"}}},[t._v("\n          join now\n        ")])],1)])])])},staticRenderFns:[]};var o=s("VU/8")(n,r,!1,function(t){s("W47L")},"data-v-39e9a85f",null);e.default=o.exports}});