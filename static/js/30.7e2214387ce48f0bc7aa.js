webpackJsonp([30],{"6oB1":function(t,e){},aJyR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),l=i.n(s),c=i("z2X1"),a=i.n(c),n={data:function(){return{lang:this.$i18n.locale,checkedAll:!1,selectTotal:0,selectTotalPrice:"0.00",payPrice:0,list:[],userinfo:[],discountList:[],discountNum:0}},created:function(){this.getUserDiscount(),this.getCartList(),this.userinfo=a.a.getItem("userinfo")},methods:{goHome:function(){this.$router.push("/")},goGoodsCart:function(){this.$router.push("/cart")},getUserDiscount:function(){var t=this;t.$request.getUserdiscount().then(function(e){1==e.code&&(t.discountList=e.data)})},getCartList:function(){var t=this;t.$request.RepairCartGetList({}).then(function(e){if(1==e.code){for(var i in e.data.list){var s=e.data.list[i].price*e.data.list[i].nums;e.data.list[i].totalPrice=t.returnFloat(s),e.data.list[i].checked=!1}t.list=e.data.list}})},setCatItemNums:function(t,e,i){var s=0,l=0,c=this.selectTotalPrice;if(1==this.list[e].nums&&"jian"==i)return!1;"jia"==i?(s=this.list[e].nums+1,l=Number(this.list[e].totalPrice,2)+Number(this.list[e].price,2),c=Number(c,2)+Number(this.list[e].price,2)):"jian"==i&&(s=this.list[e].nums-1,l=Number(this.list[e].totalPrice,2)-Number(this.list[e].price,2),c=Number(c,2)-Number(this.list[e].price,2)),s<=1&&(s=1),this.$request.RepairCartSetNums({id:t.id,nums:s}).then(),this.list[e].nums=s,this.list[e].totalPrice=this.returnFloat(l),!0===t.checked&&(this.selectTotalPrice=this.returnFloat(c),this.handleDiscount())},returnFloat:function(t){var e=(t=Math.round(100*parseFloat(t))/100).toString().split(".");return 1==e.length?t=t.toString()+".00":e.length>1?(e[1].length<2&&(t=t.toString()+"0"),t):void 0},selectCartAll:function(t){var e=0;for(var i in this.list)this.list[i].checked=t,!0===t&&(e+=Number(this.list[i].totalPrice));!0===t?this.selectTotal=this.list.length:(this.selectTotal=0,e=0,this.discountNum=0),this.selectTotalPrice=this.returnFloat(e),this.handleDiscount()},selectCartItem:function(t,e){var i=this.selectTotalPrice;!0===t.checked?(this.selectTotal++,i=Number(i)+Number(t.totalPrice)):(this.selectTotal--,i=Number(i)-Number(t.totalPrice)),this.selectTotal==this.list.length?this.checkedAll=!0:this.checkedAll=!1,this.selectTotalPrice=this.returnFloat(i),this.handleDiscount()},deleteCar:function(t,e){var i=[],s=this,l=[];if(void 0==t||null==t||""==t){for(var c in s.list)!0===s.list[c].checked&&(i.push(s.list[c].id),s.list[c].indexkey=c,l.push(s.list[c]));if(i.length<=0)return s.$message.error("Please select an goods"),!1;i=i.join(",")}else i=t.id,t.indexkey=e,l.push(t);s.$request.RepairCartDel({id:i}).then(function(e){if(1==e.code){if(s.$message.success("Deleted successfully"),void 0==t||null==t||""==t)s.list=[],s.selectTotalPrice="0.00",s.selectTotal=0,s.checkedAll=!1;else{for(var i in l){var c=Number(l[i].indexkey);s.list.splice(c,1)}var a=0,n=0;for(var r in s.list)!0===s.list[r].checked&&(a+=Number(s.list[r].totalPrice),n++);s.selectTotalPrice=s.returnFloat(a),s.selectTotal=n}s.handleDiscount()}})},createOrder:function(){if(void 0==this.userinfo||null==this.userinfo||""==this.userinfo)return this.$message.error("Please login first"),!1;if(this.selectTotal<=0)return this.$message.error("Please select an item"),!1;var t=[];for(var e in this.list)if(!0===this.list[e].checked){var i={model_id:this.list[e].model_id,project_id:this.list[e].project_id,nums:this.list[e].nums,cart_id:this.list[e].id,color_id:this.list[e].color_id};void 0!=this.list[e].sku&&null!=this.list[e].sku&&""!=this.list[e].sku&&(i.sku_id=this.list[e].sku.id),t.push(i)}if(t.length<=0)return this.$message.error("Please select an goods"),!1;var s=encodeURI(l()(t));this.$router.push("/repairtruepay?id="+s)},handleDiscount:function(){if(this.discountList&&this.discountList.length>0)for(var t in this.discountList){var e=this.discountList[t];e.price_start<=this.selectTotalPrice&&this.selectTotalPrice<=e.price_end&&(this.discountNum=e.preferential_quota,this.payPrice=100*Number(this.selectTotalPrice)*Number(this.discountNum)/1e4,this.payPrice=this.returnFloat(this.payPrice))}0==this.selectTotal&&(this.discountNum=0)}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"web_cart_container"},[s("div",{staticClass:"view_nav"},[s("div",{staticClass:"go_nav",on:{click:function(e){return t.goHome()}}},[t._v("Home")]),t._v(" "),s("div",[t._v(">")]),t._v(" "),s("div",[t._v("My Cart")])]),t._v(" "),s("div",{staticClass:"order_type_con"},[s("div",{staticClass:"fl",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.goGoodsCart()}}},[t._v("Goods carts")]),t._v(" "),s("div",{staticClass:"fl order_type_con_active"},[t._v("My Repair carts")])]),t._v(" "),s("div",{staticClass:"web_infocontainer web_cartinfo_container"},[s("div",{staticClass:"web_cart_thead"},[s("div",{staticClass:"column t-checkbox"},[s("el-checkbox",{on:{change:t.selectCartAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v(t._s("ch"==t.lang?"全选":"Select all"))])],1),t._v(" "),s("div",{staticClass:"column t-goods"},[t._v(t._s("ch"==t.lang?"设备":"Items"))]),t._v(" "),s("div",{staticClass:"column t-price"},[t._v(t._s("ch"==t.lang?"单价":"Unit Price"))]),t._v(" "),s("div",{staticClass:"column t-quantity"},[t._v(t._s("ch"==t.lang?"数量":"Quantity"))]),t._v(" "),s("div",{staticClass:"column t-sum"},[t._v(t._s("ch"==t.lang?"小计":"Subtotal"))]),t._v(" "),s("div",{staticClass:"column t-action"},[t._v(t._s("ch"==t.lang?"操作":""))])]),t._v(" "),s("div",{staticClass:"web_cart_contents"},[t.list&&t.list.length>0?s("div",t._l(t.list,function(e,i){return s("div",{key:i,staticClass:"web_cart_item"},[s("div",{staticClass:"web_cart_item-item",class:e.checked?"web_cart_item-itemselect":""},[s("div",{staticClass:"item-form"},[s("div",{staticClass:"cell p-checkbox"},[s("el-checkbox",{on:{change:function(s){return t.selectCartItem(e,i)}},model:{value:e.checked,callback:function(i){t.$set(e,"checked",i)},expression:"item.checked"}})],1),t._v(" "),s("div",{staticClass:"cell p-goods"},[s("img",{attrs:{src:e.phonemodel.full_image,alt:""}}),t._v(" "),s("div",{staticClass:"goods_info"},[s("div",{staticClass:"title"},[t._v(t._s(e.phonemodel.title)),s("span",{staticStyle:{"font-weight":"normal",color:"#00a0e9"}},[t._v("("+t._s("ch"==t.lang?t.color.title_zh:e.color.title)+")")])]),t._v(" "),s("div",[e.project_id_txt?s("div",{staticClass:"sku_con"},t._l(e.project_id_txt,function(e,i){return s("div",{key:i,staticClass:"sku"},[t._v("\n                        "+t._s("ch"==t.lang?e.title_zh:e.title)+"\n                      ")])}),0):t._e()])])]),t._v(" "),s("div",{staticClass:"cell p-price"},[t._v("$"+t._s(e.price))]),t._v(" "),s("div",{staticClass:"cell p-quantity"},[s("div",{staticClass:"jian",on:{click:function(s){return t.setCatItemNums(e,i,"jian")}}},[t._v("-")]),t._v(" "),s("input",{staticClass:"nums",attrs:{type:"text"},domProps:{value:e.nums}}),t._v(" "),s("div",{staticClass:"jia",on:{click:function(s){return t.setCatItemNums(e,i,"jia")}}},[t._v("+")])]),t._v(" "),s("div",{staticClass:"cell p-sum"},[t._v("$"+t._s(e.totalPrice))]),t._v(" "),s("div",{staticClass:"cell p-ops"},[s("el-popconfirm",{attrs:{"confirm-button-text":"True","cancel-button-text":"False",icon:"el-icon-info","icon-color":"red",title:"Are you sure you want to delete？"},on:{confirm:function(s){return t.deleteCar(e,i)}}},[s("el-button",{staticClass:"web_car_delbtn",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v(t._s("ch"==t.lang?"删除":"Delete"))])],1)],1)])])])}),0):s("div",{staticStyle:{width:"max-content",margin:"auto","text-align":"center"}},[s("img",{staticStyle:{width:"150px"},attrs:{src:i("mAJy"),alt:""}}),t._v(" "),s("div",[t._v("You haven't joined the shopping cart yet,\n          "),s("router-link",{staticStyle:{color:"#00a0e9",cursor:"pointer"},attrs:{to:{path:"/repair"}}},[t._v("\n            join now\n          ")])],1)])])]),t._v(" "),s("div",{staticClass:"web_cart-toolbar"},[s("div",{staticClass:"left fl"},[s("el-checkbox",{on:{change:t.selectCartAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v(t._s("ch"==t.lang?"全选":"Select all"))]),t._v(" "),s("div",{staticClass:"delete_all_btn",on:{click:function(e){return t.deleteCar()}}},[t._v(t._s("ch"==t.lang?"删除选中的商品":"Delete the selected items"))])],1),t._v(" "),s("div",{staticClass:"right fr"},[s("div",[s("div",[s("div",{staticClass:"fl",staticStyle:{"margin-right":"15px"}},[t._v(t._s("ch"==t.lang?"已选择":"Selected")),s("span",{staticStyle:{color:"#e2231a","font-weight":"700","font-family":"verdana",margin:"0 3px"}},[t._v(t._s(t.selectTotal))]),t._v(t._s("ch"==t.lang?"件商品":"items"))]),t._v(" "),s("div",{staticClass:"fl",staticStyle:{"margin-right":"30px"}},[t._v(t._s("ch"==t.lang?"总价":"Total price")+"："),s("span",{staticStyle:{"font-size":"16px",color:"#e2231a","font-family":"verdana","font-weight":"700"}},[t._v("$"+t._s(t.selectTotalPrice))])]),t._v(" "),t.payPrice>0?s("div",{staticClass:"fl",staticStyle:{"margin-right":"30px"}},[t._v(t._s("ch"==t.lang?"支付价":"Payment price")+"："),s("span",{staticStyle:{"font-size":"16px",color:"#e2231a","font-family":"verdana","font-weight":"700"}},[t._v("$"+t._s(t.payPrice))])]):t._e()]),t._v(" "),t.discountNum>0?s("div",{staticClass:"PreferentialTips"},[t._v("\n          优惠 "),s("span",{staticStyle:{color:"#00a0e9"}},[t._v(t._s(t.discountNum)+"%")])]):t._e()]),t._v(" "),s("div",{staticClass:"common-submit-btn",on:{click:function(e){return t.createOrder()}}},[t._v(t._s("ch"==t.lang?"去结算":"Pay"))])])])])},staticRenderFns:[]};var o=i("VU/8")(n,r,!1,function(t){i("6oB1")},"data-v-10ec6a0e",null);e.default=o.exports}});